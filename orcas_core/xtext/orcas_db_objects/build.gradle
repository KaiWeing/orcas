task(createSqlplusDir) 
{
  doFirst
  {
    new File("${buildDir}/sqlplus/db/packages").mkdirs();
    new File("${buildDir}/sqlplus/db/types").mkdirs();
  }
  outputs.file "${buildDir}/sqlplus/db/packages"
  outputs.file "${buildDir}/sqlplus/db/types"
}

import org.apache.tools.ant.filters.ReplaceTokens

task(copyPackages, dependsOn: createSqlplusDir, type: Copy) 
{
  inputs.property("extensionparameter",project.ext.extensionparameter)
  from "../../sql_util_scripts/replaceable"
  into "${buildDir}/sqlplus/db/packages"

  filter(ReplaceTokens, tokens: [extensionparameter: project.ext.extensionparameter])
  exclude "*_ot*"
}

task(copyTypes, dependsOn: createSqlplusDir, type: Copy) 
{
  from "../../sql_util_scripts/replaceable"
  into "${buildDir}/sqlplus/db/types"

  include "*_ot*"
}

task sqlplusJar( type: Zip ) {
  classifier = 'sqlplus'
  baseName = project.name
  version = project.version
  destinationDir = file("${buildDir}/libs")
  from fileTree(dir: "${buildDir}/sqlplus")
}

configurations.create( "default" )

artifacts.add( "default", sqlplusJar )

sqlplusJar.dependsOn copyPackages, copyTypes


task(build, dependsOn: sqlplusJar) 
{
}

task clean(type: Delete) {
  delete buildDir
}

